<div class="cadastro-responsavel">
  <div class="page-header">
    <h1>{{ isEditMode ? 'Editar Responsável' : 'Novo Responsável' }}</h1>
    <div class="header-actions">
      <button class="btn-secondary" (click)="cancelar()">
        ← Voltar
      </button>
    </div>
  </div>

  <!-- Mensagens -->
  <div *ngIf="error" class="alert alert-error">
    {{ error }}
  </div>

  <div *ngIf="success" class="alert alert-success">
    {{ success }}
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading-overlay">
    <div class="spinner"></div>
    <p>{{ isEditMode ? 'Carregando dados...' : 'Salvando responsável...' }}</p>
  </div>

  <!-- Formulário -->
  <form [formGroup]="responsavelForm" (ngSubmit)="onSubmit()" class="responsavel-form">
    
    <!-- Dados Pessoais -->
    <div class="form-section">
      <h3>Dados do Responsável</h3>
      <div class="form-grid">
        
        <div class="form-group">
          <label for="nome">Nome Completo *</label>
          <input type="text" 
                 id="nome" 
                 formControlName="nome"
                 [class.invalid]="isFieldInvalid('nome')"
                 placeholder="Digite o nome completo">
          <div *ngIf="isFieldInvalid('nome')" class="field-error">
            {{ getFieldError('nome') }}
          </div>
        </div>

        <div class="form-group">
          <label for="email">E-mail *</label>
          <input type="email" 
                 id="email" 
                 formControlName="email"
                 [class.invalid]="isFieldInvalid('email')"
                 placeholder="responsavel@empresa.com">
          <div *ngIf="isFieldInvalid('email')" class="field-error">
            {{ getFieldError('email') }}
          </div>
        </div>

        <div class="form-group">
          <label for="telefone">Telefone *</label>
          <input type="text" 
                 id="telefone" 
                 formControlName="telefone"
                 [class.invalid]="isFieldInvalid('telefone')"
                 placeholder="(11) 99999-9999"
                 maxlength="15"
                 (input)="formatarTelefone($event)">
          <div *ngIf="isFieldInvalid('telefone')" class="field-error">
            {{ getFieldError('telefone') }}
          </div>
        </div>

        <div class="form-group">
          <label for="cargo">Cargo/Função *</label>
          <input type="text" 
                 id="cargo" 
                 formControlName="cargo"
                 [class.invalid]="isFieldInvalid('cargo')"
                 placeholder="Ex: Gerente de Operações">
          <div *ngIf="isFieldInvalid('cargo')" class="field-error">
            {{ getFieldError('cargo') }}
          </div>
        </div>

        <div class="form-group">
          <label for="unidadeId">Unidade *</label>
          <select id="unidadeId" 
                  formControlName="unidadeId"
                  [class.invalid]="isFieldInvalid('unidadeId')">
            <option value="">Selecione a unidade</option>
            <option *ngFor="let unidade of unidadesDisponiveis" [value]="unidade.id">
              {{ unidade.nome }}
            </option>
          </select>
          <div *ngIf="isFieldInvalid('unidadeId')" class="field-error">
            {{ getFieldError('unidadeId') }}
          </div>
        </div>

        <div class="form-group" *ngIf="isEditMode">
          <label for="status">Status</label>
          <select id="status" formControlName="status">
            <option value="ATIVO">Ativo</option>
            <option value="INATIVO">Inativo</option>
          </select>
        </div>

      </div>
    </div>

    <!-- Ações do Formulário -->
    <div class="form-actions">
      <div class="actions-left">
      </div>
      
      <div class="actions-right">
        <button type="button" 
                class="btn-secondary" 
                (click)="cancelar()">
          Cancelar
        </button>
        <button type="submit" 
                class="btn-primary"
                [disabled]="responsavelForm.invalid || loading">
          {{ isEditMode ? 'Atualizar' : 'Criar' }} Responsável
        </button>
      </div>
    </div>

  </form>

</div>